RDS_HOST: data-handling-project-readonly.cq2e8zno855e.eu-west-1.rds.amazonaws.com
RDS_PASSWORD: AiCore2022
RDS_USER: aicore_admin
RDS_DATABASE: postgres
RDS_PORT: 5432

import psycopg2
import yaml

class DatabaseConnector:
    def __init__(self):
        self.connection = None
        self.cursor = None
        self.load_db_creds()

    def load_db_creds(self):
        with open('db_creds.yaml', 'r') as f:
            db_creds = yaml.safe_load(f)
            self.host = db_creds['RDS_HOST']
            self.database = db_creds['RDS_DATABASE']
            self.user = db_creds['RDS_USER']
            self.password = db_creds['RDS_PASSWORD']
            self.port = db_creds['RDS_PORT']

    def connect(self):
        try:
            self.connection = psycopg2.connect(
                host=self.host,
                database=self.database,
                user=self.user,
                password=self.password,
                port=self.port
            )
            self.cursor = self.connection.cursor()
        except psycopg2.Error as e:
            print(f"Error connecting to database: {e}")

    def extract_data(self, table_name):
        if not self.connection or not self.cursor:
            raise Exception("Database connection not established")

        try:
            self.cursor.execute(f"SELECT * FROM {table_name}")
            data = self.cursor.fetchall()
            return data
        except psycopg2.Error as e:
            print(f"Error extracting data from database: {e}")

    def close_connection(self):
        if self.connection:
            self.connection.close()
